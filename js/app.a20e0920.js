(function(){"use strict";var t={4363:function(t,e,i){var a=i(6369),r=i(8499),s=i.n(r),l=i(4582),n=i(2198),o=i(5743),c=i.n(o),d=(i(1015),i(841)),u=i.n(d),f=i(8263),h=i.n(f),m=i(922),p=i.n(m),g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper",attrs:{id:"app"}},[e("router-view")],1)},b=[],y=i(1001),v={},_=(0,y.Z)(v,g,b,!1,null,null,null),w=_.exports,E=i(2631),S=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"blue-wrap"},[e("div",{staticClass:"container"},[e("div",{staticClass:"top-bar"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.changeRoleTitle,placement:"bottom-end"}},[e("i",{staticClass:"text_24 text_white cp",class:t.userIcon,on:{click:t.changeRole}})])],1),e("p",{staticClass:"text_white text_b mb_20",staticStyle:{"font-size":"80px"}},[t._v(" Кольцово ")]),e("p",{staticClass:"text_40 text_white mb_40"},[t._v("Онлайн-табло")]),e("el-radio-group",{model:{value:t.component,callback:function(e){t.component=e},expression:"component"}},[e("el-radio-button",{attrs:{label:"ScoreboardDeparture",border:""}},[t._v("Вылет")]),e("el-radio-button",{attrs:{label:"ScoreboardArrival",border:""}},[t._v("Прилёт")])],1),e("img",{staticClass:"plane",attrs:{src:"/back-img.png",alt:""}})],1)]),e("div",{staticClass:"container mt_40"},[e(t.component,{tag:"component"})],1)])},T=[],k=i(3822);const x="CITIES_GET",$="AIRLINES_GET",C="USER_ROLE_CHANGE";var I=function(){var t=this,e=t._self._c;return e("scoreboard-table")},A=[];const F="FLIGHTS_LIST_REQUEST",D="FLIGHTS_LIST_SUCCESS",V="FLIGHT_ADD",O="FLIGHT_UPDATE",L="FLIGHT_DELETE",j="TYPE_SET";var N=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.flights.loading,expression:"flights.loading"}]},[e("div",{staticClass:"flex mb_32"},[e("el-input",{attrs:{size:"small",placeholder:"Поиск"},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}}),t.dictionary.isAdmin?e("el-button",{staticClass:"ml_24",attrs:{size:"small",type:"success"},on:{click:function(e){t.formVisible=!0}}},[t._v(" Добавить рейс ")]):t._e()],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.search}},[e("el-table-column",{attrs:{label:"Время по расписанию","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("p",[t._v(t._s(t.$dayjs(i.row.dateTime).utc(!0).format("DD.MM LT")))])]}}])}),e("el-table-column",{attrs:{label:"№ рейса","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(i.row.flightNumber))])]}}])}),e("el-table-column",{attrs:{label:"Авиакомпания","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.airline.name,placement:"top-start"}},[e("img",{staticClass:"airline-logo",attrs:{src:t.row.airline.logoLink,alt:t.row.airline.name}})])]}}])}),e("el-table-column",{attrs:{label:"Направление","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("p",[t._v(t._s(i.row.direction))])]}}])}),e("el-table-column",{attrs:{label:"Статус","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("p",{class:t.statusColor(i.row.dateTime)},[t._v(" "+t._s(t.statusTitle(i.row.dateTime))+" ")])]}}])}),t.dictionary.isAdmin?e("el-table-column",{attrs:{align:"right","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{staticClass:"mr_8",attrs:{icon:"el-icon-edit",size:"mini"},on:{click:function(e){return t.handleEdit(i.row)}}}),e("el-popconfirm",{attrs:{title:"Удалить рейс?"},on:{confirm:function(e){return t.handleDelete(i.row)}}},[e("el-button",{attrs:{slot:"reference",size:"mini",icon:"el-icon-delete",type:"danger"},slot:"reference"})],1)]}}],null,!1,1241782978)}):t._e()],1),e("flight-edit-form",{attrs:{flight:t.flight,"form-visible":t.formVisible},on:{"update:flight":function(e){t.flight=e},"update:formVisible":function(e){t.formVisible=e},"update:form-visible":function(e){t.formVisible=e}}})],1)},P=[],Z=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.titles.dialogTitle,visible:t.dialogVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(e){t.dialogVisible=e},open:t.init,closed:t.closed}},[t.flightEdit?e("el-form",{ref:"flightForm",attrs:{model:t.flightEdit,rules:t.rules,"label-position":"top"},nativeOn:{submit:function(t){t.preventDefault()}}},[e("div",{staticClass:"flex"},[e("el-form-item",{staticClass:"mr_32",attrs:{label:t.titles.direction,prop:"direction"}},[e("el-autocomplete",{staticStyle:{width:"220px"},attrs:{"fetch-suggestions":t.citySuggestion,clearable:""},on:{select:t.cityHandleSelect},scopedSlots:t._u([{key:"default",fn:function({item:i}){return[e("div",{staticClass:"value"},[t._v(t._s(i))])]}}],null,!1,2643476368),model:{value:t.flightEdit.direction,callback:function(e){t.$set(t.flightEdit,"direction",e)},expression:"flightEdit.direction"}})],1),e("el-form-item",{attrs:{label:t.titles.dateTime,prop:"dateTime"}},[e("el-date-picker",{attrs:{type:"datetime","picker-options":t.pickerOptions,placeholder:"Выберите дату и время"},model:{value:t.flightEdit.dateTime,callback:function(e){t.$set(t.flightEdit,"dateTime",e)},expression:"flightEdit.dateTime"}})],1)],1),e("div",{staticClass:"flex"},[e("el-form-item",{staticClass:"mr_32",attrs:{label:"Авиакомпания",prop:"airlineId"}},[e("el-select",{staticStyle:{width:"220px"},attrs:{label:"Выбор авиакомпании",remote:"","remote-method":t.getAirlines,filterable:"",placeholder:"Выбрать"},on:{change:t.setAirline},model:{value:t.flightEdit.airlineId,callback:function(e){t.$set(t.flightEdit,"airlineId",e)},expression:"flightEdit.airlineId"}},t._l(t.airlines,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:"Номер рейса",prop:"flightNumber"}},[e("el-input",{staticStyle:{width:"220px"},model:{value:t.flightEdit.flightNumber,callback:function(e){t.$set(t.flightEdit,"flightNumber",e)},expression:"flightEdit.flightNumber"}})],1)],1)]):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("Отмена")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v(t._s(t.titles.saveButton))])],1)],1)},R=[];class U{constructor(t,e){this.id=t?.id,this.airline=t?.airline,this.airlineId=t?.airlineId,this.flightNumber=t?.flightNumber,this.direction=t?.direction||"",this.type=t?.type||e,this.dateTime=t?.dateTime,this.filter=null}getFilter(){return`${this.airline?.name}_${this.flightNumber}_${this.direction}`}}var G={name:"flight-edit-form",props:["formVisible","flight"],data(){return{dialogVisible:!1,flightEdit:null,pickerOptions:{firstDayOfWeek:1,disabledDate(t){return t.getTime()<(new Date).setDate((new Date).getDate()-1)}},rules:{dateTime:[{required:!0,message:"Укажите дату",trigger:"change"}],airlineId:[{required:!0,message:"Выберите авиакомпанию",trigger:"change"}],flightNumber:[{required:!0,message:"Введите номер рейса",trigger:"blur"}],direction:[{required:!0,message:"Укажите направление",trigger:"change"}]}}},watch:{formVisible(t){this.dialogVisible=t}},computed:{...(0,k.Se)(["dictionary","flights"]),airlines(){return this.flightEdit?.airlineId&&!this.dictionary.airlines.length?[this.flightEdit?.airline]:this.dictionary.airlines},titles(){return{direction:"arrival"===this.flights?.type?"Укажите город отправления":"Укажите город назначения",dateTime:"arrival"===this.flights?.type?"Укажите время прилёта":"Укажите время вылета",dialogTitle:"arrival"===this.flights?.type?"Редактирования прилета":"Редактирование вылета",saveButton:this.flightEdit?.id?"Сохранить вылет":"Добавить вылет"}}},methods:{init(){this.flightEdit=this.flight?new U(this.flight):new U(null,this.flights.type),this.getAirlines(this.flightEdit.airline?.name??"")},closed(){this.$emit("update:formVisible",!1),this.$emit("update:flight",null),this.flightEdit=null},getAirlines(t){this.$store.dispatch($,t)},citySuggestion(t,e){this.$store.dispatch(x,this.capitalize(t)),e(this.dictionary.cities)},setAirline(t){this.flightEdit.airline=this.dictionary.airlines.find((e=>e.id===t))},cityHandleSelect(t){this.flightEdit.direction=t},submitForm(){this.$refs.flightForm.validate((t=>{if(t){this.flightEdit.filter=this.flightEdit.getFilter();const{...t}=this.flightEdit;t.dateTime=this.$dayjs(t.dateTime).format("YYYY-MM-DDTHH:mm:ss"),t.id||delete t.id,this.flightEdit.id?this.saveFlight(t):this.addFlight(t)}return!1}))},addFlight(t){this.$store.dispatch(V,t).then((()=>{this.$message({message:"Рейс успешно добавлен",type:"success"}),this.init(),this.$nextTick((()=>{this.$refs.flightForm.clearValidate()}))}))},saveFlight(t){this.$store.dispatch(O,t).then((()=>{this.$message({message:"Рейс успешно сохранен",type:"success"}),this.dialogVisible=!1}))},capitalize(t){return`${t[0]?.toUpperCase()}${t.slice(1)}`}}},H=G,z=(0,y.Z)(H,Z,R,!1,null,"791f2234",null),M=z.exports,J={name:"scoreboard-table",components:{FlightEditForm:M},data(){return{flight:null,searchQuery:"",formVisible:!1}},computed:{...(0,k.Se)(["flights","dictionary"]),search(){return this.flights.items.filter((t=>t?.filter.toLowerCase().includes(this.searchQuery.toLowerCase())))}},methods:{statusTitle(t){return this.$dayjs().isAfter(this.$dayjs(t))?"Прибыл":"Ожидается"},statusColor(t){return{green:this.$dayjs().isAfter(this.$dayjs(t))}},handleEdit(t){this.flight=t,this.formVisible=!0},handleDelete(t){this.$store.dispatch(L,t)}}},Q=J,q=(0,y.Z)(Q,N,P,!1,null,"164ef502",null),Y=q.exports,B={name:"scoreboard-arrival",components:{ScoreboardTable:Y},created(){this.$store.commit(j,"arrival"),this.$store.dispatch(F,"arrival")}},K=B,X=(0,y.Z)(K,I,A,!1,null,"14835724",null),W=X.exports,tt=function(){var t=this,e=t._self._c;return e("scoreboard-table")},et=[],it={name:"scoreboard-departure",components:{ScoreboardTable:Y},created(){this.$store.commit(j,"departure"),this.$store.dispatch(F)}},at=it,rt=(0,y.Z)(at,tt,et,!1,null,"586afc28",null),st=rt.exports,lt={name:"ScoreboardView",components:{ScoreboardDeparture:st,ScoreboardArrival:W},data(){return{component:"ScoreboardDeparture"}},created(){this.$route.query.admin&&this.changeRole()},computed:{...(0,k.Se)(["dictionary"]),userIcon(){return this.dictionary.isAdmin?"el-icon-s-custom":"el-icon-user"},changeRoleTitle(){return this.dictionary.isAdmin?"Переключиться в режим пользователя":"Переключиться в режим администратора"}},methods:{changeRole(){this.$store.commit(C)}}},nt=lt,ot=(0,y.Z)(nt,S,T,!1,null,null,null),ct=ot.exports;a["default"].use(E.ZP);const dt=[{path:"/",name:"scoreboard",component:ct}],ut=new E.ZP({mode:"history",base:"/",routes:dt});var ft=ut,ht=(i(7658),i(7795)),mt=i(36);const pt={apiKey:"AIzaSyANC3ujkVpixUF_ctmn15n0KESNVpmmGIA",authDomain:"airport-scoreboard.firebaseapp.com",databaseURL:"https://airport-scoreboard-default-rtdb.europe-west1.firebasedatabase.app",projectId:"airport-scoreboard",storageBucket:"airport-scoreboard.appspot.com",messagingSenderId:"810866443431",appId:"1:810866443431:web:b4d060fdf74ac8b0a8c782"},gt=(0,ht.ZF)(pt),bt=(0,mt.ad)(gt),yt={flights:{items:[],type:"",loading:!1}},vt={flights:()=>yt.flights},_t={async[F]({commit:t}){t(F);const e=(0,mt.IO)((0,mt.hJ)(bt,"flights"),(0,mt.ar)("type","==",yt.flights.type),(0,mt.Xo)("dateTime")),i=await(0,mt.PL)(e);if(i.empty)t(D,[]);else{const e=[];i.forEach((t=>{const i=t.data();i.id=t.id,e.push(i)})),t(D,e)}},async[V]({dispatch:t},e){const i=await(0,mt.ET)((0,mt.hJ)(bt,"flights"),e);return t(F),i},async[O]({dispatch:t},e){await(0,mt.pl)((0,mt.JU)(bt,"flights",e.id),e),t(F)},async[L]({dispatch:t},e){await(0,mt.oe)((0,mt.JU)(bt,"flights",e.id)),t(F)}},wt={[F]:t=>{t.flights.loading=!0},[D]:(t,e)=>{t.flights.items=e,t.flights.loading=!1},[j]:(t,e)=>{t.flights.type=e}};var Et={state:yt,getters:vt,actions:_t,mutations:wt};const St={apiKey:"AIzaSyANC3ujkVpixUF_ctmn15n0KESNVpmmGIA",authDomain:"airport-scoreboard.firebaseapp.com",databaseURL:"https://airport-scoreboard-default-rtdb.europe-west1.firebasedatabase.app",projectId:"airport-scoreboard",storageBucket:"airport-scoreboard.appspot.com",messagingSenderId:"810866443431",appId:"1:810866443431:web:b4d060fdf74ac8b0a8c782"},Tt=(0,ht.ZF)(St),kt=(0,mt.ad)(Tt),xt={dictionary:{cities:[],airlines:[],isAdmin:!1}},$t={dictionary:()=>xt.dictionary},Ct={async[x]({commit:t},e){const i=(0,mt.IO)((0,mt.hJ)(kt,"cities"),(0,mt.ar)("name",">=",e),(0,mt.Xo)("name"),(0,mt.b9)(10)),a=await(0,mt.PL)(i);if(a.empty)t(x,[]);else{const e=[];a.forEach((t=>{e.push(t.data())})),t(x,e)}},async[$]({commit:t},e){const i=(0,mt.IO)((0,mt.hJ)(kt,"airlines"),(0,mt.ar)("name",">=",e),(0,mt.Xo)("name"),(0,mt.b9)(10)),a=await(0,mt.PL)(i);if(a.empty)t($,[]);else{const e=[];a.forEach((t=>{const i=t.data();i.logoLink&&(i.id=t.id,e.push(i))})),t($,e)}}},It={[x]:(t,e)=>{t.dictionary.cities=e.map((t=>t.name))},[$]:(t,e)=>{t.dictionary.airlines=e},[C]:t=>{t.dictionary.isAdmin=!t.dictionary.isAdmin}};var At={state:xt,getters:$t,actions:Ct,mutations:It};a["default"].use(k.ZP);var Ft=new k.ZP.Store({modules:{Flights:Et,Dictionary:At}});c().locale("ru"),c().extend(h()),c().extend(p()),c().extend(u()),a["default"].prototype.$dayjs=c(),l["default"].use(n.Z),a["default"].use(s()),a["default"].config.productionTip=!1,new a["default"]({router:ft,store:Ft,render:t=>t(w)}).$mount("#app")}},e={};function i(a){var r=e[a];if(void 0!==r)return r.exports;var s=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=t,function(){var t=[];i.O=function(e,a,r,s){if(!a){var l=1/0;for(d=0;d<t.length;d++){a=t[d][0],r=t[d][1],s=t[d][2];for(var n=!0,o=0;o<a.length;o++)(!1&s||l>=s)&&Object.keys(i.O).every((function(t){return i.O[t](a[o])}))?a.splice(o--,1):(n=!1,s<l&&(l=s));if(n){t.splice(d--,1);var c=r();void 0!==c&&(e=c)}}return e}s=s||0;for(var d=t.length;d>0&&t[d-1][2]>s;d--)t[d]=t[d-1];t[d]=[a,r,s]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var a in e)i.o(e,a)&&!i.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,a){var r,s,l=a[0],n=a[1],o=a[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(r in n)i.o(n,r)&&(i.m[r]=n[r]);if(o)var d=o(i)}for(e&&e(a);c<l.length;c++)s=l[c],i.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return i.O(d)},a=self["webpackChunkairport_scoreboard"]=self["webpackChunkairport_scoreboard"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(4363)}));a=i.O(a)})();
//# sourceMappingURL=app.a20e0920.js.map